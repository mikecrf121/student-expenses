<ion-content class="speaker-detail">
  <ion-header class="ion-no-border">
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-back-button defaultHref="/reports-manager/reports"
          style="color: beige;background:black;border-radius: 30%;"></ion-back-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <div class="speaker-background"></div>

  <!--Skeleton-->
  <div *ngIf="!data">
    <h3>
      <b><u></u></b>
    </h3>
    <h1>
      <ion-skeleton-text animated style="width: 30%"></ion-skeleton-text>
    </h1>
    <br />
    <h3>
      <ion-skeleton-text animated style="width: 40%"></ion-skeleton-text><br />
    </h3>
    <ion-row *ngFor="let item of deadData">
      <ion-col>
        <ion-item>
          <ion-skeleton-text animated style="width: 100%; size: 25px"><br /><br /></ion-skeleton-text>
        </ion-item>
      </ion-col>
    </ion-row>
  </div>

  <div *ngIf="data">
    <ion-row>
      <ion-col>
        <h3>
          <b><u>Report Details</u></b>:
        </h3>
      </ion-col>
      <ion-col>

      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item (click)="editReportAttribute('reportName')"><b>Report Name:&nbsp; </b> {{reportName}}
        </ion-item>
        <ion-item><b>Created:&nbsp; </b> {{reportCreated}} </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <h3>
          <u><b>Report Students</b></u>:&nbsp;({{reportStudents.length}})
        </h3>
        <ion-button end size="medium" style="vertical-align: center; text-align: right" shape="round" fill="clear"
          routerLink="{{currentRoute}}/students/add">
          <ion-icon name="add-outline"></ion-icon>Add Student
        </ion-button>
      </ion-col>
    </ion-row>

    <ion-grid fixed *ngIf="data">
      <ion-row>
        <ion-col size="12" size-md="6" *ngFor="let account of reportStudents">
          <ion-card class="speaker-card">
            <ion-item detail="false" lines="none" class="speaker-item"
              routerLink="{{currentRoute}}/students/student-details/{{account.id}}">
              <ion-label>
                <div>
                  <ion-avatar style="text-align: center">
                    <img src="../../../../assets/img/avatar.svg" style="text-align: center" />
                  </ion-avatar>
                  <h2>{{account.firstName}} {{account.lastName}}</h2>
                  <ion-badge *ngIf="account.isOnline" color="success">
                    ONLINE
                  </ion-badge>
                  <ion-badge *ngIf="!account.isOnline" color="medium">
                    OFFLINE
                  </ion-badge>
                  <p *ngIf="account.isOnline" style="visibility: hidden;;"> IM ONLINE<span></span></p>
                  <p *ngIf="!account.isOnline">
                    L|O:
                    <span *ngIf="account.lastLogin">{{account.lastLogin}}</span><span
                      *ngIf="!account.lastLogin">N/A</span>
                  </p>
                </div>
              </ion-label>
              <ion-label>
                <p>
                  <b><u>All Expenses</u></b>
                </p>
                <p>( {{account.studentExpensesCount}} )</p>
              </ion-label>
            </ion-item>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-row>
      <ion-col>
        <h3>
          <u><b>Report Expenses</b></u>:&nbsp;({{reportExpenses.length}}) {{totalOfReportExpensesString}}
        </h3>
      </ion-col>
    </ion-row>

    <ion-grid fixed>
      <ion-row>
        <ion-col size="12" size-md="6" *ngFor="let expense of reportExpenses">
          <ion-card class="speaker-card">
            <!--<ion-card-header>-->
            <ion-item detail="false" lines="none" class="speaker-item"
              routerLink="{{currentRoute}}/report-expenses/expense-details/{{expense.id}}">
              <ion-avatar slot="start">
                <img src="../../../../assets/img/money.png" [alt]="'Expense Image'" />
              </ion-avatar>
              <ion-label>
                <h1>{{expense.expenseName}}</h1>
                <p>${{expense.expenseCost}}</p>
                <p>
                  Created By: {{expense.expenseStudent[0].firstName}}
                  {{expense.expenseStudent[0].lastName}}
                </p>
                <p>{{expense.created}}</p>
                <p>{{expense.expenseCategory}}</p>
              </ion-label>
            </ion-item>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-row>
    </ion-row>

    <ion-row>
      <ion-col>
        <h3>
          <u><b>Report Disbursements</b></u>:
        </h3>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-grid>
        <ion-row>
          <ion-col size="12" size-md="12" *ngFor="let student of reportStudents">
            <ion-card class="speaker-card" routerLink="{{currentRoute}}/students/student-details/{{student.id}}">
              <ion-card-header>
                <ion-item detail="false" lines="none">
                  <ion-label>
                    <h1><b>{{student.firstName}} {{student.lastName}}</b></h1>
                    <h3>Rpt. Expenses: ( {{student.studentExpensesCountOnReport}} )</h3>
                    <h4>Total: ${{student.expensesTotal}}</h4>
                  </ion-label>
                  <ion-label>
                    <h2>
                      <b><u>DISBURSEMENT</u></b>
                    </h2>
                    <ion-skeleton-text animated style="width: 20%"
                      *ngIf="!disbursementResults && calculatingDisbursements"></ion-skeleton-text>
                    <span *ngIf="student.disbursementAmmount<0 && disbursementResults" style="color: green">Owed
                      {{student.disbursementAmmountAbsoluteValueCurrencyString}}</span><span
                      *ngIf="student.disbursementAmmount>0 && disbursementResults" style="color: red">Owes
                      {{student.disbursementAmmountAbsoluteValueCurrencyString}}</span><b></b>
                  </ion-label>
                </ion-item>
              </ion-card-header>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-button expand="full" shape="block" color="success" (click)="calculateDisbursements()">Calculate
          Disbursements
        </ion-button>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-button expand="full" shape="block" color="warning" (click)="archiveAreYouSure()">Archive Report
        </ion-button>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="viewingAccount.role=='Admin'">
      <ion-col>
        <ion-button expand="full" shape="block" color="danger" (click)="deleteAreYouSure()">Delete Report</ion-button>
      </ion-col>
    </ion-row>
  </div>
</ion-content>
